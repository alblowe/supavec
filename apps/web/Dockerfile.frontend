FROM node:20

WORKDIR /app

COPY . .

# Enable pnpm and install it
RUN corepack enable && corepack prepare pnpm@8.10.5 --activate

# Install all dependencies
RUN pnpm install

# Build the frontend
WORKDIR /app/apps/web
RUN pnpm build

# Start server
EXPOSE 3000
CMD ["pnpm", "start"]
